---
// src/pages/codigo-conducta/[...lang].astro - Código de Conducta dinámico multiidioma
import Layout from '../../layouts/Layout.astro';
import '../../styles/conduct.css';
import { getTranslation, getLocalizedPageUrl } from '../../i18n/utils.js';

export async function getStaticPaths() {
  return [
    { params: { lang: undefined } },  
    { params: { lang: 'en' } },
    { params: { lang: 'ca' } },       // Para /ca (catalán)
    { params: { lang: 'pt' } }        
  ];
}

const { lang } = Astro.params;

const locale = lang || 'es';
const translations = getTranslation(locale);
const t = translations as any;

const pageTitle = t.conduct?.page_title || 'Código de Conducta - B4OS';
const pageDescription = t.conduct?.page_description || 'Código de conducta para la comunidad B4OS';

const backHomeUrl = locale === 'es' ? '/' : `/${locale}`;
---

<Layout 
  title={pageTitle}
  description={pageDescription}
  locale={locale}
  noindex={true}
>
    <header class="header" role="banner">
        <nav class="nav" role="navigation" aria-label="Navegación principal">
            <div class="nav-container">
                <div class="nav-brand">
                    <a href={backHomeUrl} class="nav-link" aria-label={t.conduct.nav.back_home_aria}>
                        <img src="/b4os.png" alt={t.conduct.nav.logo_alt} class="logo" width="64" height="64">
                    </a>
                </div>
                <div class="nav-menu">
                    <button onclick="window.history.back()" class="nav-link nav-close-btn">{t.conduct.nav.close_btn}</button>
                </div>
            </div>
        </nav>
    </header>

    <main class="terms-page">
    <div class="container">
        <article class="terms-content">
        <header class="terms-header">
            <h1>{t.conduct.header.title}</h1>
            <p class="terms-intro">{t.conduct.header.intro}</p>
        </header>

        <section class="terms-section">
            <h2>{t.conduct.sections.commitment.title}</h2>
            <p>{t.conduct.sections.commitment.content}</p>
        </section>

        <section class="terms-section">
            <h2>{t.conduct.sections.standards.title}</h2>
            
            <div class="info-box">
                <h3>Comportamiento esperado</h3>
                <ul>
                    {t.conduct.sections.standards.positive.items.map((item: string) => <li>{item}</li>)}
                </ul>
            </div>
        </section>

        <section class="terms-section">
            <h2>{t.conduct.sections.standards.unacceptable.title}</h2>
            <div class="conduct-box">
                <ul>
                    {t.conduct.sections.standards.unacceptable.items.map((item: string) => <li>{item}</li>)}
                </ul>
            </div>
        </section>

        <section class="terms-section">
            <h2>{t.conduct.sections.sanctions.title}</h2>
            <div class="important-box">
                <p set:html={t.conduct.sections.sanctions.content}></p>
            </div>
        </section>

        <footer class="terms-footer">
            <p><strong>{t.conduct.footer.last_updated}</strong> {t.conduct.footer.date}</p>
            <div class="terms-actions">
            <button onclick="window.history.back()" class="btn btn-primary">{t.conduct.footer.close_btn}</button>
            <a href={`${backHomeUrl}#registro`} class="btn btn-primary">{t.conduct.footer.register_btn}</a>
            </div>
        </footer>
        </article>
    </div>
    </main>

    <footer class="footer" role="contentinfo">
        <div class="container">
            <div class="footer-bottom">
                <div class="footer-bottom-content">
                    <div>
                        <p set:html={t.conduct.footer.copyright}></p>
                    </div>
                    <nav class="footer-legal" aria-label="Enlaces legales">
                        <a href={getLocalizedPageUrl('terminos', locale)} rel="nofollow">{t.footer.legal.terms}</a>
                        <a href={getLocalizedPageUrl('codigo-conducta', locale)} rel="nofollow">{t.footer.legal.conduct}</a>
                    </nav>
                </div>
            </div>
        </div>
    </footer>
</Layout>